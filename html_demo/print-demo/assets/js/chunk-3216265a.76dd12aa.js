(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3216265a"],{"3c16":function(e,a,t){"use strict";var r=t("fec1"),i=t.n(r);i.a},"403e":function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,r=e._self._c||a;return r("div",{staticClass:"hospitalDoctorAddPage"},[r("title-common",[r("span",{attrs:{slot:"title"},slot:"title"},[e._v("添加医生")])]),r("panel-common",[r("div",{attrs:{slot:"info-title"},slot:"info-title"},[e._v("基本信息")]),r("div",{attrs:{slot:"info-content"},slot:"info-content"},[r("el-form",{ref:"baseInfoFormRef",attrs:{model:e.baseInfoForm,rules:e.baseInfoFormRules,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"医生姓名",prop:"name"}},[r("el-input",{attrs:{clearable:"",placeholder:"请填写医生真实姓名"},on:{blur:e.changeName},model:{value:e.baseInfoForm.name,callback:function(a){e.$set(e.baseInfoForm,"name",a)},expression:"baseInfoForm.name"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"登录用户名"}},[r("el-input",{attrs:{disabled:""},model:{value:e.baseInfoForm.login_name,callback:function(a){e.$set(e.baseInfoForm,"login_name",a)},expression:"baseInfoForm.login_name"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"初始密码",prop:"password"}},[r("el-input",{model:{value:e.baseInfoForm.password,callback:function(a){e.$set(e.baseInfoForm,"password",a)},expression:"baseInfoForm.password"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"医生手机",prop:"phone"}},[r("el-input",{attrs:{clearable:"",placeholder:"请填写医生手机"},model:{value:e.baseInfoForm.phone,callback:function(a){e.$set(e.baseInfoForm,"phone","string"===typeof a?a.trim():a)},expression:"baseInfoForm.phone"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"岗位名称"}},[r("el-input",{attrs:{clearable:"",placeholder:"请填写岗位名称"},model:{value:e.baseInfoForm.station,callback:function(a){e.$set(e.baseInfoForm,"station",a)},expression:"baseInfoForm.station"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"医生职称",prop:"grade_id"}},[r("el-select",{attrs:{placeholder:"请选择医生职称"},model:{value:e.baseInfoForm.grade_id,callback:function(a){e.$set(e.baseInfoForm,"grade_id",a)},expression:"baseInfoForm.grade_id"}},e._l(e.levellist,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"所属科室",prop:"dep_id"}},[r("el-select",{attrs:{placeholder:"请选择所属科室"},model:{value:e.baseInfoForm.dep_id,callback:function(a){e.$set(e.baseInfoForm,"dep_id",a)},expression:"baseInfoForm.dep_id"}},e._l(e.roomlist,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"挂号类别",prop:"make_type_id"}},[r("el-select",{attrs:{placeholder:"请选择挂号类别"},model:{value:e.baseInfoForm.make_type_id,callback:function(a){e.$set(e.baseInfoForm,"make_type_id",a)},expression:"baseInfoForm.make_type_id"}},e._l(e.typelist,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"擅长"}},[r("el-input",{attrs:{type:"textarea",placeholder:"医生擅长"},model:{value:e.baseInfoForm.skilled,callback:function(a){e.$set(e.baseInfoForm,"skilled",a)},expression:"baseInfoForm.skilled"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"简介"}},[r("el-input",{attrs:{type:"textarea",placeholder:"可补充说明"},model:{value:e.baseInfoForm.introduction,callback:function(a){e.$set(e.baseInfoForm,"introduction",a)},expression:"baseInfoForm.introduction"}})],1)],1)],1)],1)],1)]),r("panel-common",[r("div",{attrs:{slot:"info-title"},slot:"info-title"},[e._v("认证信息")]),r("div",{attrs:{slot:"info-content"},slot:"info-content"},[r("el-form",{ref:"idInfoFormRef",attrs:{model:e.idInfoForm,rules:e.idInfoFormRules,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"身份证号码",prop:"id_card"}},[r("el-input",{staticClass:"input-id",attrs:{clearable:""},model:{value:e.idInfoForm.id_card,callback:function(a){e.$set(e.idInfoForm,"id_card","string"===typeof a?a.trim():a)},expression:"idInfoForm.id_card"}})],1)],1)],1),r("el-row",[r("el-col",[r("el-form-item",{attrs:{label:"身份证照片上传","label-width":"110px"}},[r("div",{staticClass:"upload-img-id"},[r("div",[r("ol",[e._l(e.IDPic1,(function(a,i){return r("li",{key:i+"_10"},[r("img",{attrs:{src:a.img,alt:""}}),r("p",[e._v("身份证正面")]),r("span",{on:{click:function(t){return e.handleDelIDUp(a.id)}}},[r("img",{attrs:{src:t("a308"),alt:""}})])])})),r("li",{directives:[{name:"show",rawName:"v-show",value:e.IDPic1.length<1,expression:"IDPic1.length < 1"}]},[r("input",{attrs:{type:"file",id:"signature21",accept:"image/jpeg, image/jpg, image/png"},on:{change:e.changeID1}}),r("label",{staticClass:"label-k",attrs:{for:"signature21"}}),r("p",{staticClass:"click"},[e._v("点击上传")])])],2)]),r("div",[r("ol",[e._l(e.IDPic2,(function(a,i){return r("li",{key:i+"_11"},[r("img",{attrs:{src:a.img,alt:""}}),r("p",[e._v("身份证反面")]),r("span",{on:{click:function(t){return e.handleDelIDDown(a.id)}}},[r("img",{attrs:{src:t("a308"),alt:""}})])])})),r("li",{directives:[{name:"show",rawName:"v-show",value:e.IDPic2.length<1,expression:"IDPic2.length < 1"}]},[r("input",{attrs:{type:"file",id:"signature13",accept:"image/jpeg, image/jpg, image/png"},on:{change:e.changeID2}}),r("label",{staticClass:"label-k",attrs:{for:"signature13"}}),r("p",{staticClass:"click"},[e._v("点击上传")])])],2)])])])],1)],1),r("el-row",[r("el-col",[r("el-form-item",{attrs:{label:"资格证明"}},[r("div",{staticClass:"upload-img"},[r("div",[r("ol",[e._l(e.ZYZPic2,(function(a,i){return r("li",{key:i+"_12"},[r("img",{attrs:{src:a.img,alt:""}}),r("p",[e._v("医生执业证")]),r("span",{on:{click:function(t){return e.handleDelZYZ(a.id)}}},[r("img",{attrs:{src:t("a308"),alt:""}})])])})),r("li",{directives:[{name:"show",rawName:"v-show",value:e.ZYZPic2.length<1,expression:"ZYZPic2.length < 1"}]},[r("input",{attrs:{type:"file",id:"signature2",accept:"image/jpeg, image/jpg, image/png"},on:{change:e.changeZYZ2}}),r("label",{staticClass:"label-k",attrs:{for:"signature2"}}),r("p",{staticClass:"click"},[e._v("点击上传")])])],2)]),r("div",[r("ol",[e._l(e.ZGZPic2,(function(a,i){return r("li",{key:i+"_13"},[r("img",{attrs:{src:a.img,alt:""}}),r("p",[e._v("医生资格证")]),r("span",{on:{click:function(t){return e.handleDelZGZ(a.id)}}},[r("img",{attrs:{src:t("a308"),alt:""}})])])})),r("li",{directives:[{name:"show",rawName:"v-show",value:e.ZGZPic2.length<1,expression:"ZGZPic2.length < 1"}]},[r("input",{attrs:{type:"file",id:"signature3",accept:"image/jpeg, image/jpg, image/png"},on:{change:e.changeZGZ2}}),r("label",{staticClass:"label-k",attrs:{for:"signature3"}}),r("p",{staticClass:"click"},[e._v("点击上传")])])],2)]),r("div",[r("ol",[e._l(e.ZCZPic2,(function(a,i){return r("li",{key:i+"_14"},[r("img",{attrs:{src:a.img,alt:""}}),r("p",[e._v("职称证")]),r("span",{on:{click:function(t){return e.handleDelZCZ(a.id)}}},[r("img",{attrs:{src:t("a308"),alt:""}})])])})),r("li",{directives:[{name:"show",rawName:"v-show",value:e.ZCZPic2.length<1,expression:"ZCZPic2.length < 1"}]},[r("input",{attrs:{type:"file",id:"signature4",accept:"image/jpeg, image/jpg, image/png"},on:{change:e.changeZCZ2}}),r("label",{staticClass:"label-k",attrs:{for:"signature4"}}),r("p",{staticClass:"click"},[e._v("点击上传")])])],2)])])])],1)],1),r("el-row",[r("el-col",[r("el-form-item",{attrs:{label:"电子签名"}},[r("div",{staticClass:"up-file"},[r("input",{attrs:{type:"file",id:"signature",accept:"image/jpeg, image/jpg, image/png"},on:{change:e.changeSignature}}),r("label",{class:e.signaturePic?"label-m":"label-k",attrs:{for:"signature"}},[e._v(" "+e._s(e.signaturePic?"重新上传":"")+" ")]),r("p",{directives:[{name:"show",rawName:"v-show",value:!e.signaturePic,expression:"!signaturePic"}],staticClass:"click"},[e._v("点击上传")]),r("img",{attrs:{src:e.signaturePic,alt:""}})])])],1)],1),r("el-row",[r("el-col",[r("el-form-item",{attrs:{label:"签名方式"}},[r("el-radio-group",{model:{value:e.idInfoForm.signature_type,callback:function(a){e.$set(e.idInfoForm,"signature_type",a)},expression:"idInfoForm.signature_type"}},[r("el-radio",{attrs:{label:2}},[e._v("电子签名")]),r("el-radio",{attrs:{label:1}},[e._v("手写签名")])],1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"分配角色",prop:"group_id"}},[r("el-select",{attrs:{placeholder:"普通医师"},model:{value:e.idInfoForm.group_id,callback:function(a){e.$set(e.idInfoForm,"group_id",a)},expression:"idInfoForm.group_id"}},e._l(e.rolelist,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("el-row",[r("el-col",[r("el-form-item",{attrs:{label:"开通服务"}},[r("el-checkbox-group",{model:{value:e.idInfoForm.serve_id,callback:function(a){e.$set(e.idInfoForm,"serve_id",a)},expression:"idInfoForm.serve_id"}},e._l(e.servelist,(function(a){return r("el-checkbox",{key:a.id,attrs:{label:a.id}},[e._v(" "+e._s(a.name)+" ")])})),1)],1)],1)],1)],1)],1)]),r("div",{staticClass:"btns"},[r("el-button",{attrs:{type:"primary",loading:e.isLoading},on:{click:e.handleSave}},[e._v("保存")]),r("el-button",{attrs:{plain:""},on:{click:function(a){return e.$router.go(-1)}}},[e._v("取消")])],1)],1)},i=[],n=(t("dbb3"),t("2eeb"),t("053b"),t("e18c"),t("1c2e"),t("6a61"),t("cf7f")),o=t("ce3c"),s=t("a041"),l=t("2a94"),c=t("7584"),d=t("19d3"),u={data:function(){var e,a=function(e,a,t){var r=/^1[3456789]\d{9}$/;r.test(a)?t():t(new Error("手机号格式不正确！"))},t=function(e,a,t){var r=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;r.test(a)?t():t(new Error("身份账号格式不正确！"))};return e={baseInfoForm:{name:"",login_name:"",password:"",phone:"",station:"",grade_id:"",dep_id:"",make_type_id:"",skilled:"",introduction:""},baseInfoFormRules:{name:[{required:!0,message:"请输入医生姓名",trigger:"blur"}],password:[{required:!0,message:"请输入初始密码",trigger:"blur"}],phone:[{required:!0,message:"请输入医生手机",trigger:"blur"},{validator:a,trigger:"blur"}],grade_id:[{required:!0,message:"请输入医生手机",trigger:"blur"}],level:[{required:!0,message:"请选择医生职称",trigger:"blur"}],dep_id:[{required:!0,message:"请选择所属科室",trigger:"blur"}],make_type_id:[{required:!0,message:"请选择挂号类别",trigger:"blur"}]},idInfoForm:{id_card:"",signature_type:1,group_id:"",serve_id:[]},idInfoFormRules:{id_card:[{required:!0,message:"请输入身份证号码",trigger:"blur"},{validator:t,trigger:"blur"}],group_id:[{required:!0,message:"请选择角色",trigger:"blur"}]},dialogImageUrl:"",dialogVisible:!1,disabled:!1,rolelist:[],roomlist:[],levellist:[],typelist:[],servelist:[],IDPic1:[],IDPic2:[],ZYZPic2:[],ZGZPic2:[],ZCZPic2:[],signaturePic:"",signatureFile:"",loading:!1},Object(o["a"])(e,"dialogVisible",!1),Object(o["a"])(e,"isShow",!1),Object(o["a"])(e,"isLoading",!1),e},components:{TitleCommon:s["a"],PanelCommon:l["a"]},created:function(){this._showAddDoctor()},methods:{_showAddDoctor:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var t,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(c["d"])();case 2:t=a.sent,r=t.data,0!==r.code?e.$message.error(r.msg):(e.rolelist=r.data.authGroup,e.roomlist=r.data.department,r.data.department.length<=0&&e.$message.error("请先添加科室名称，再添加医生"),e.levellist=r.data.grade,e.typelist=r.data.makeType,e.servelist=r.data.serve);case 6:case"end":return a.stop()}}),a)})))()},changeName:function(){var e=this;if(e.baseInfoForm.name){var a=/[^\u4e00-\u9fa5]/g;if(a.test(e.baseInfoForm.name))return void e.$message.error("医生姓名请输入中文，不能有其他字符、空格或数字!")}else e.baseInfoForm.login_name;var t=Object(d["a"])(e.baseInfoForm.name);this.addNumber(t)},addNumber:function(e){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=a,t.next=3,Object(c["b"])({loginName:e});case 3:if(i=t.sent,n=i.data,0===n.code){t.next=15;break}if(3e3!=n.code){t.next=12;break}r.baseInfoForm.login_name=e+=(1e9*Math.random()).toString().substring(0,3),t.next=13;break;case 12:return t.abrupt("return",r.$message.error("校验医生登录名失败！"));case 13:t.next=16;break;case 15:r.baseInfoForm.login_name=e;case 16:case"end":return t.stop()}}),t)})))()},handleDelIDUp:function(e){this.IDPic1=this.IDPic1.filter((function(a){return a.id!==e}))},changeID1:function(e){var a=e||window.event,t=a.target.files[0];if(t){var r=new FileReader;r.vue=this,r.readAsDataURL(t),r.onload=function(){var e={};e.id=1e4*Math.random(),e.img=this.result,e.file=t,this.vue.IDPic1.push(e)},a.target.value=""}},handleDelIDDown:function(e){this.IDPic2=this.IDPic2.filter((function(a){return a.id!==e}))},changeID2:function(e){var a=e||window.event,t=a.target.files[0];if(t){var r=new FileReader;r.vue=this,r.readAsDataURL(t),r.onload=function(){var e={};e.id=1e4*Math.random(),e.img=this.result,e.file=t,this.vue.IDPic2.push(e)},a.target.value=""}},handleDelZYZ:function(e){this.ZYZPic2=this.ZYZPic2.filter((function(a){return a.id!==e}))},changeZYZ2:function(e){var a=e||window.event,t=a.target.files[0];if(t){var r=new FileReader;r.vue=this,r.readAsDataURL(t),r.onload=function(){var e={};e.id=1e4*Math.random(),e.img=this.result,e.file=t,this.vue.ZYZPic2.push(e)},a.target.value=""}},changeZGZ2:function(e){var a=e||window.event,t=a.target.files[0];if(t){var r=new FileReader;r.vue=this,r.readAsDataURL(t),r.onload=function(){var e={};e.id=1e4*Math.random(),e.img=this.result,e.file=t,this.vue.ZGZPic2.push(e)},a.target.value=""}},handleDelZGZ:function(e){this.ZGZPic2=this.ZGZPic2.filter((function(a){return a.id!==e}))},changeZCZ2:function(e){var a=e||window.event,t=a.target.files[0];if(t){var r=new FileReader;r.vue=this,r.readAsDataURL(t),r.onload=function(){var e={};e.id=1e4*Math.random(),e.img=this.result,e.file=t,this.vue.ZCZPic2.push(e)},a.target.value=""}},handleDelZCZ:function(e){this.ZCZPic2=this.ZCZPic2.filter((function(a){return a.id!==e}))},changeSignature:function(e){var a=e||window.event,t=a.target.files[0];if(t){var r=new FileReader;r.vue=this,r.readAsDataURL(t),this.signatureFile=t,r.onload=function(){this.vue.signaturePic=this.result}}},handleSave:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var t,r,i,n,o,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t=/^1[3456789]\d{9}$/,r=/[^\u4e00-\u9fa5]/g,i=/^[0-9a-zA-Z]{6,20}$/,e.baseInfoForm.name){a.next=9;break}return e.$message.error("请完善医生姓名"),a.abrupt("return");case 9:if(!r.test(e.baseInfoForm.name)){a.next=12;break}return e.$message.error("医生姓名请输入中文，不能有其他字符、空格或数字"),a.abrupt("return");case 12:if(e.baseInfoForm.password){a.next=15;break}return e.$message.error("请设置初始密码"),a.abrupt("return");case 15:if(!(e.baseInfoForm.password.length<6||e.baseInfoForm.password.length>20)){a.next=18;break}return e.$message.error("初始密码设置长度为6~20位！"),a.abrupt("return");case 18:if(i.test(e.baseInfoForm.password)){a.next=21;break}return e.$message.error("初始密码请输入英文和数字，不能有其他字符、空格或汉子"),a.abrupt("return");case 21:if(e.baseInfoForm.phone){a.next=24;break}return e.$message.error("请完善医生手机号"),a.abrupt("return");case 24:if(t.test(e.baseInfoForm.phone)){a.next=27;break}return e.$message.error("请填写正确的医生手机号"),a.abrupt("return");case 27:if(e.baseInfoForm.grade_id){a.next=30;break}return e.$message.error("请完善医生职称"),a.abrupt("return");case 30:if(e.baseInfoForm.dep_id){a.next=33;break}return e.$message.error("请完善所属科室"),a.abrupt("return");case 33:if(e.baseInfoForm.make_type_id){a.next=36;break}return e.$message.error("请完善挂号类别"),a.abrupt("return");case 36:if(e.idInfoForm.id_card){a.next=39;break}return e.$message.error("请完善身份证号码"),a.abrupt("return");case 39:if(e.idInfoForm.group_id){a.next=42;break}return e.$message.error("请完善分配角色"),a.abrupt("return");case 42:if(2!=e.idInfoForm.signature_type||e.signatureFile){a.next=45;break}return e.$message.error("请上传电子签名"),a.abrupt("return");case 45:return e.isLoading=!0,n=new FormData,n.append("name",e.baseInfoForm.name),n.append("phone",e.baseInfoForm.phone),n.append("password",e.baseInfoForm.password),n.append("station",e.baseInfoForm.station),n.append("login_name",e.baseInfoForm.login_name),n.append("grade_id",e.baseInfoForm.grade_id),n.append("dep_id",e.baseInfoForm.dep_id),n.append("make_type_id",e.baseInfoForm.make_type_id),n.append("skilled",e.baseInfoForm.skilled),n.append("introduction",e.baseInfoForm.introduction),n.append("id_card",e.idInfoForm.id_card),n.append("signature_type",e.idInfoForm.signature_type),n.append("group_id",e.idInfoForm.group_id),n.append("serve_id",e.idInfoForm.serve_id),e.IDPic1.map((function(e){n.append("pic1",e.file)})),e.IDPic2.map((function(e){n.append("pic2",e.file)})),e.ZYZPic2.map((function(e){n.append("pic3",e.file)})),e.ZGZPic2.map((function(e){n.append("pic4",e.file)})),e.ZCZPic2.map((function(e){n.append("pic5",e.file)})),e.signatureFile&&n.append("pic6",e.signatureFile),a.next=70,Object(c["g"])(n);case 70:o=a.sent,s=o.data,0!==s.code?e.$message.error(s.msg):(e.$message.success("添加医生成功！"),e.$router.go(-1)),e.isLoading=!1;case 75:case"end":return a.stop()}}),a)})))()}}},m=u,p=(t("3c16"),t("9ca4")),f=Object(p["a"])(m,r,i,!1,null,"76a3d6a4",null);a["default"]=f.exports},fec1:function(e,a,t){}}]);