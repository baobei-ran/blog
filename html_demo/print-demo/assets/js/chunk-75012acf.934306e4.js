(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75012acf"],{"210a":function(e,t,r){},"7c2c":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"hospitalDoctorEditPage"},[i("title-common",[i("span",{attrs:{slot:"title"},slot:"title"},[e._v("编辑医生")])]),i("panel-common",[i("div",{attrs:{slot:"info-title"},slot:"info-title"},[e._v("基本信息")]),i("div",{attrs:{slot:"info-content"},slot:"info-content"},[i("el-form",{ref:"editDoctorFormRef",attrs:{model:e.editDoctorForm,rules:e.editDoctorFormRules,"label-width":"100px"}},[i("el-row",[i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"医生姓名",prop:"name"}},[i("el-input",{attrs:{clearable:"",placeholder:"请填写医生真实姓名"},on:{blur:e.changeName},model:{value:e.editDoctorForm.name,callback:function(t){e.$set(e.editDoctorForm,"name",t)},expression:"editDoctorForm.name"}})],1)],1),i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"登录用户名"}},[i("el-input",{attrs:{disabled:""},model:{value:e.editDoctorForm.login_name,callback:function(t){e.$set(e.editDoctorForm,"login_name",t)},expression:"editDoctorForm.login_name"}})],1)],1),i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"医生手机",prop:"phone"}},[i("el-input",{attrs:{clearable:"",placeholder:"请填写医生手机"},model:{value:e.editDoctorForm.phone,callback:function(t){e.$set(e.editDoctorForm,"phone",t)},expression:"editDoctorForm.phone"}})],1)],1)],1),i("el-row",[i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"岗位名称"}},[i("el-input",{attrs:{clearable:"",placeholder:"请填写岗位名称"},model:{value:e.editDoctorForm.station,callback:function(t){e.$set(e.editDoctorForm,"station",t)},expression:"editDoctorForm.station"}})],1)],1),i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"医生职称",prop:"grade_id"}},[i("el-select",{attrs:{placeholder:"请选择医生职称"},model:{value:e.editDoctorForm.grade_id,callback:function(t){e.$set(e.editDoctorForm,"grade_id",t)},expression:"editDoctorForm.grade_id"}},e._l(e.levellist,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"所属科室",prop:"dep_id"}},[i("el-select",{attrs:{placeholder:"请选择所属科室"},model:{value:e.editDoctorForm.dep_id,callback:function(t){e.$set(e.editDoctorForm,"dep_id",t)},expression:"editDoctorForm.dep_id"}},e._l(e.roomlist,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),i("el-col",{attrs:{span:6}},[i("el-form-item",{attrs:{label:"挂号类别",prop:"make_type_id"}},[i("el-select",{attrs:{placeholder:"请选择挂号类别"},model:{value:e.editDoctorForm.make_type_id,callback:function(t){e.$set(e.editDoctorForm,"make_type_id",t)},expression:"editDoctorForm.make_type_id"}},e._l(e.typelist,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"擅长"}},[i("el-input",{attrs:{type:"textarea",placeholder:"医生擅长"},model:{value:e.editDoctorForm.skilled,callback:function(t){e.$set(e.editDoctorForm,"skilled",t)},expression:"editDoctorForm.skilled"}})],1)],1)],1),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"简介"}},[i("el-input",{attrs:{type:"textarea",placeholder:"可补充说明"},model:{value:e.editDoctorForm.introduction,callback:function(t){e.$set(e.editDoctorForm,"introduction",t)},expression:"editDoctorForm.introduction"}})],1)],1)],1)],1)],1)]),i("panel-common",[i("div",{attrs:{slot:"info-title"},slot:"info-title"},[e._v("认证信息")]),i("div",{attrs:{slot:"info-content"},slot:"info-content"},[i("el-form",{ref:"editDoctorFormRef",attrs:{model:e.editDoctorForm,rules:e.editDoctorFormRules,"label-width":"100px"}},[i("el-row",[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"身份证号码",prop:"id_card"}},[i("el-input",{staticClass:"input-id",attrs:{clearable:""},model:{value:e.editDoctorForm.id_card,callback:function(t){e.$set(e.editDoctorForm,"id_card",t)},expression:"editDoctorForm.id_card"}})],1)],1)],1),i("el-row",[i("el-col",[i("el-form-item",{attrs:{label:"身份证照片上传","label-width":"110px"}},[i("div",{staticClass:"upload-img-id"},[i("div",[i("ol",[e._l(e.IDPic1,(function(t,a){return i("li",{key:a+"_10"},[i("img",{attrs:{src:t.img,alt:""}}),i("span",{on:{click:function(r){return e.handleDelIDUp(t.id)}}},[i("img",{attrs:{src:r("a308"),alt:""}})])])})),i("li",{directives:[{name:"show",rawName:"v-show",value:e.IDPic1.length<1,expression:"IDPic1.length < 1"}]},[i("input",{attrs:{type:"file",id:"signature2",accept:"image/jpeg, image/jpg, image/png"},on:{change:e.changeID1}}),i("label",{staticClass:"label-k",attrs:{for:"signature2"}}),i("p",{staticClass:"click"},[e._v("点击上传")])])],2),i("p",{staticClass:"upload-msg"},[e._v("身份证正面")])]),i("div",[i("ol",[e._l(e.IDPic2,(function(t,a){return i("li",{key:a+"_11"},[i("img",{attrs:{src:t.img,alt:""}}),i("span",{on:{click:function(r){return e.handleDelIDDown(t.id)}}},[i("img",{attrs:{src:r("a308"),alt:""}})])])})),i("li",{directives:[{name:"show",rawName:"v-show",value:e.IDPic2.length<1,expression:"IDPic2.length < 1"}]},[i("input",{attrs:{type:"file",id:"signature3",accept:"image/jpeg, image/jpg, image/png"},on:{change:e.changeID2}}),i("label",{staticClass:"label-k",attrs:{for:"signature3"}}),i("p",{staticClass:"click"},[e._v("点击上传")])])],2),i("p",{staticClass:"upload-msg"},[e._v("身份证正面")])])])])],1)],1),i("el-row",[i("el-col",[i("el-form-item",{attrs:{label:"资格证明"}},[i("div",{staticClass:"upload-img"},[i("div",[i("ol",[e._l(e.ZYZPic2,(function(t,a){return i("li",{key:a+"_12"},[i("img",{attrs:{src:t.img,alt:""}}),i("span",{on:{click:function(r){return e.handleDelZYZ(t.id)}}},[i("img",{attrs:{src:r("a308"),alt:""}})])])})),i("li",{directives:[{name:"show",rawName:"v-show",value:e.ZYZPic2.length<1,expression:"ZYZPic2.length < 1"}]},[i("input",{attrs:{type:"file",id:"signature22",accept:"image/jpeg, image/jpg, image/png"},on:{change:e.changeZYZ2}}),i("label",{staticClass:"label-k",attrs:{for:"signature22"}}),i("p",{staticClass:"click"},[e._v("点击上传")])])],2),i("p",{staticClass:"msg"},[e._v("医生执业证")])]),i("div",[i("ol",[e._l(e.ZGZPic2,(function(t,a){return i("li",{key:a+"_13"},[i("img",{attrs:{src:t.img,alt:""}}),i("span",{on:{click:function(r){return e.handleDelZGZ(t.id)}}},[i("img",{attrs:{src:r("a308"),alt:""}})])])})),i("li",{directives:[{name:"show",rawName:"v-show",value:e.ZGZPic2.length<1,expression:"ZGZPic2.length < 1"}]},[i("input",{attrs:{type:"file",id:"signature33",accept:"image/jpeg, image/jpg, image/png"},on:{change:e.changeZGZ2}}),i("label",{staticClass:"label-k",attrs:{for:"signature33"}}),i("p",{staticClass:"click"},[e._v("点击上传")])])],2),i("p",{staticClass:"msg"},[e._v("医生资格证")])]),i("div",[i("ol",[e._l(e.ZCZPic2,(function(t,a){return i("li",{key:a+"_14"},[i("img",{attrs:{src:t.img,alt:""}}),i("span",{on:{click:function(r){return e.handleDelZCZ(t.id)}}},[i("img",{attrs:{src:r("a308"),alt:""}})])])})),i("li",{directives:[{name:"show",rawName:"v-show",value:e.ZCZPic2.length<1,expression:"ZCZPic2.length < 1"}]},[i("input",{attrs:{type:"file",id:"signature44",accept:"image/jpeg, image/jpg, image/png"},on:{change:e.changeZCZ2}}),i("label",{staticClass:"label-k",attrs:{for:"signature44"}}),i("p",{staticClass:"click"},[e._v("点击上传")])])],2),i("p",{staticClass:"msg"},[e._v("职称证")])])])])],1)],1),i("el-row",[i("el-col",[i("el-form-item",{attrs:{label:"电子签名"}},[i("div",{staticClass:"up-file"},[i("input",{attrs:{type:"file",id:"signature",accept:"image/jpeg, image/jpg, image/png"},on:{change:e.changeSignature}}),i("label",{class:e.signaturePic?"label-m":"label-k",attrs:{for:"signature"}},[e._v(" "+e._s(e.signaturePic?"重新上传":"")+" ")]),i("p",{directives:[{name:"show",rawName:"v-show",value:!e.signaturePic,expression:"!signaturePic"}],staticClass:"click"},[e._v("点击上传")]),i("img",{attrs:{src:e.signaturePic,alt:""}})])])],1)],1),i("el-row",[i("el-col",[i("el-form-item",{attrs:{label:"签名方式"}},[i("el-radio-group",{model:{value:e.editDoctorForm.signature_type,callback:function(t){e.$set(e.editDoctorForm,"signature_type",t)},expression:"editDoctorForm.signature_type"}},[i("el-radio",{attrs:{label:2}},[e._v("电子签名")]),i("el-radio",{attrs:{label:1}},[e._v("手写签名")])],1)],1)],1)],1),i("el-row",[i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"分配角色",prop:"group_id"}},[i("el-select",{attrs:{placeholder:"普通医师"},model:{value:e.editDoctorForm.group_id,callback:function(t){e.$set(e.editDoctorForm,"group_id",t)},expression:"editDoctorForm.group_id"}},e._l(e.rolelist,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),i("el-row",[i("el-col",[i("el-form-item",{attrs:{label:"开通服务"}},[i("el-checkbox-group",{model:{value:e.editDoctorForm.serve_id,callback:function(t){e.$set(e.editDoctorForm,"serve_id",t)},expression:"editDoctorForm.serve_id"}},e._l(e.servelist,(function(t){return i("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1)],1)],1)],1)]),i("div",{staticClass:"btns"},[i("el-button",{attrs:{type:"primary",loading:e.loading,disabled:e.loading},on:{click:e.handleSave}},[e._v("保存")]),i("el-button",{attrs:{plain:""},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")])],1)],1)},a=[],o=(r("dbb3"),r("9302"),r("2eeb"),r("053b"),r("513c"),r("e18c"),r("e35a"),r("1c2e"),r("0d7a"),r("6a61"),r("cf7f")),n=r("a041"),l=r("2a94"),s=r("7584"),c=r("19d3"),d={data:function(){var e=function(e,t,r){var i=/^1[3456789]\d{9}$/;i.test(t)?r():r(new Error("手机号格式不正确！"))},t=function(e,t,r){var i=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;i.test(t)?r():r(new Error("身份账号格式不正确！"))};return{did:null,editDoctorForm:{dep_id:null,serve_id:[]},editDoctorFormRules:{name:[{required:!0,message:"请输入医生姓名",trigger:"blur"}],password:[{required:!0,message:"请输入初始密码",trigger:"blur"}],phone:[{required:!0,message:"请输入医生手机",trigger:"blur"},{validator:e,trigger:"blur"}],grade_id:[{required:!0,message:"请选择医生职称",trigger:"blur"}],dep_id:[{required:!0,message:"请选择所属科室",trigger:"blur"}],make_type_id:[{required:!0,message:"请选择挂号类别",trigger:"blur"}],id_card:[{required:!0,message:"请输入身份证号码",trigger:"blur"},{validator:t,trigger:"blur"}],group_id:[{required:!0,message:"请选择角色",trigger:"blur"}]},rolelist:[],roomlist:[],levellist:[],typelist:[],servelist:[],IDPic1:[],IDPic2:[],ZYZPic2:[],ZGZPic2:[],ZCZPic2:[],signaturePic:"",signatureFile:"",loading:!1}},components:{TitleCommon:n["a"],PanelCommon:l["a"]},created:function(){this.did=this.$route.query.did,this._showEditDoctor()},methods:{_showEditDoctor:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["e"])({id:e.did});case 2:r=t.sent,i=r.data,0!==i.code?e.$message.error(i.msg):(e.editDoctorForm=i.data.list,e.rolelist=i.data.default.authGroup,e.levellist=i.data.default.grade,e.roomlist=i.data.default.department,e.typelist=i.data.default.makeType,e.servelist=i.data.default.serve,a=e.editDoctorForm.serve_id?e.editDoctorForm.serve_id.split(","):[],a=a.filter((function(e){return""!==e})),a=a.map((function(e){return Number(e)})),e.editDoctorForm.serve_id=a,i.data.list.pic1&&e.IDPic1.push({img:i.data.list.pic1}),i.data.list.pic2&&e.IDPic2.push({img:i.data.list.pic2}),i.data.list.pic3&&e.ZYZPic2.push({img:i.data.list.pic3}),i.data.list.pic4&&e.ZGZPic2.push({img:i.data.list.pic4}),i.data.list.pic5&&e.ZCZPic2.push({img:i.data.list.pic5}),e.signaturePic=i.data.list.pic6);case 6:case"end":return t.stop()}}),t)})))()},changeName:function(){var e=this;if(e.editDoctorForm.name){var t=/[^\u4e00-\u9fa5]/g;if(t.test(e.editDoctorForm.name))return void e.$message.error("医生姓名请输入中文，不能有其他字符、空格或数字!")}else e.editDoctorForm.login_name;var r=Object(c["a"])(e.editDoctorForm.name);this.addNumber(r)},addNumber:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var i,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return i=t,r.next=3,Object(s["b"])({loginName:i.editDoctorForm.login_name});case 3:if(a=r.sent,o=a.data,0===o.code){r.next=14;break}if(3e3!=o.code){r.next=11;break}i.editDoctorForm.login_name=e+=(1e9*Math.random()).toString().substring(0,3),r.next=12;break;case 11:return r.abrupt("return",i.$message.error(o.msg));case 12:r.next=15;break;case 14:i.editDoctorForm.login_name=e;case 15:case"end":return r.stop()}}),r)})))()},handleDelIDUp:function(e){this.IDPic1=this.IDPic1.filter((function(t){return t.id!==e}))},changeID1:function(e){var t=e||window.event,r=t.target.files[0];if(r){var i=new FileReader;i.vue=this,i.readAsDataURL(r),i.onload=function(){var e={};e.id=1e4*Math.random(),e.img=this.result,e.file=r,this.vue.IDPic1.push(e)},t.target.value=""}},handleDelIDDown:function(e){this.IDPic2=this.IDPic2.filter((function(t){return t.id!==e}))},changeID2:function(e){var t=e||window.event,r=t.target.files[0];if(r){var i=new FileReader;i.vue=this,i.readAsDataURL(r),i.onload=function(){var e={};e.id=1e4*Math.random(),e.img=this.result,e.file=r,this.vue.IDPic2.push(e)},t.target.value=""}},handleDelZYZ:function(e){this.ZYZPic2=this.ZYZPic2.filter((function(t){return t.id!==e}))},changeZYZ2:function(e){var t=e||window.event,r=t.target.files[0];if(r){var i=new FileReader;i.vue=this,i.readAsDataURL(r),i.onload=function(){var e={};e.id=1e4*Math.random(),e.img=this.result,e.file=r,this.vue.ZYZPic2.push(e)},t.target.value=""}},changeZGZ2:function(e){var t=e||window.event,r=t.target.files[0];if(r){var i=new FileReader;i.vue=this,i.readAsDataURL(r),i.onload=function(){var e={};e.id=1e4*Math.random(),e.img=this.result,e.file=r,this.vue.ZGZPic2.push(e)},t.target.value=""}},handleDelZGZ:function(e){this.ZGZPic2=this.ZGZPic2.filter((function(t){return t.id!==e}))},changeZCZ2:function(e){var t=e||window.event,r=t.target.files[0];if(r){var i=new FileReader;i.vue=this,i.readAsDataURL(r),i.onload=function(){var e={};e.id=1e4*Math.random(),e.img=this.result,e.file=r,this.vue.ZCZPic2.push(e)},t.target.value=""}},handleDelZCZ:function(e){this.ZCZPic2=this.ZCZPic2.filter((function(t){return t.id!==e}))},changeSignature:function(e){var t=e||window.event,r=t.target.files[0];if(r){var i=new FileReader;i.vue=this,i.readAsDataURL(r),this.signatureFile=r,i.onload=function(){this.vue.signaturePic=this.result}}},handleSave:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,i,a,o,n,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=/^1[3456789]\d{9}$/,i=/[^\u4e00-\u9fa5]/g,e.editDoctorForm.name){t.next=5;break}return e.$message.error("请完善医生姓名"),t.abrupt("return");case 5:if(!i.test(e.editDoctorForm.name)){t.next=8;break}return e.$message.error("医生姓名请输入中文，不能有其他字符、空格或数字"),t.abrupt("return");case 8:if(e.editDoctorForm.phone){t.next=11;break}return e.$message.error("请完善医生手机号"),t.abrupt("return");case 11:if(r.test(e.editDoctorForm.phone)){t.next=14;break}return e.$message.error("请填写正确的医生手机号"),t.abrupt("return");case 14:if(e.editDoctorForm.grade_id){t.next=17;break}return e.$message.error("请完善医生职称"),t.abrupt("return");case 17:if(e.editDoctorForm.dep_id){t.next=20;break}return e.$message.error("请完善所属科室"),t.abrupt("return");case 20:if(e.editDoctorForm.make_type_id){t.next=23;break}return e.$message.error("请完善挂号类别"),t.abrupt("return");case 23:if(e.editDoctorForm.id_card){t.next=26;break}return e.$message.error("请完善身份证号码"),t.abrupt("return");case 26:if(e.editDoctorForm.group_id){t.next=29;break}return e.$message.error("请完善分配角色"),t.abrupt("return");case 29:if(2!=e.editDoctorForm.signature_type||e.signaturePic){t.next=32;break}return e.$message.error("请上传电子签名"),t.abrupt("return");case 32:return e.loading=!0,a=new FormData,a.append("id",e.editDoctorForm.id),a.append("login_name",e.editDoctorForm.login_name),a.append("phone",e.editDoctorForm.phone),a.append("name",e.editDoctorForm.name),a.append("station",e.editDoctorForm.station),a.append("grade_id",e.editDoctorForm.grade_id),a.append("dep_id",e.editDoctorForm.dep_id),a.append("make_type_id",e.editDoctorForm.make_type_id),a.append("skilled",e.editDoctorForm.skilled),a.append("introduction",e.editDoctorForm.introduction),a.append("id_card",e.editDoctorForm.id_card),a.append("group_id",e.editDoctorForm.group_id),o=e.editDoctorForm.serve_id.length?e.editDoctorForm.serve_id.join(","):"",a.append("serve_id",o),a.append("signature_type",e.editDoctorForm.signature_type),e.IDPic1.map((function(e){e.file&&a.append("pic1",e.file)})),e.IDPic2.map((function(e){e.file&&a.append("pic2",e.file)})),e.ZYZPic2.map((function(e){e.file&&a.append("pic3",e.file)})),e.ZGZPic2.map((function(e){e.file&&a.append("pic4",e.file)})),e.ZCZPic2.map((function(e){e.file&&a.append("pic5",e.file)})),e.signatureFile&&a.append("pic6",e.signatureFile),t.next=57,Object(s["h"])(a);case 57:n=t.sent,l=n.data,0!==l.code?e.$message.error(l.msg):(e.$message.success("编辑医生信息成功！"),e.$router.go(-1)),e.loading=!1;case 62:case"end":return t.stop()}}),t)})))()}}},u=d,m=(r("de6b"),r("9ca4")),p=Object(m["a"])(u,i,a,!1,null,"2aca6c88",null);t["default"]=p.exports},de6b:function(e,t,r){"use strict";var i=r("210a"),a=r.n(i);a.a}}]);